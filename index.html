<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ULTRA Video Editor</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Poppins;background:#0b0b0b;color:#fff}
header{height:55px;background:#111;display:flex;align-items:center;padding:0 15px;color:#ff2c55;font-weight:bold}
.main{display:flex;height:calc(100vh - 115px)}
.tools{width:70px;background:#141414;display:flex;flex-direction:column;align-items:center;padding-top:10px}
.tool{width:45px;height:45px;margin:6px 0;background:#222;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px}
.tool:hover{background:#ff2c55}
.preview{flex:1;background:#000;display:flex;align-items:center;justify-content:center;position:relative}
canvas{background:#000;border-radius:10px;cursor:move}
.panel{width:320px;background:#141414;padding:12px;overflow:auto}
.panel h3{margin-top:0;color:#ff2c55}
.panel button,input,select{width:100%;margin-top:6px;padding:6px;border:none;border-radius:6px}
.panel button{background:#ff2c55;color:#fff;cursor:pointer}
.timeline{height:60px;background:#111;display:flex;align-items:center;padding:0 10px;overflow-x:auto}
.track{background:#222;height:30px;width:140px;margin-right:6px;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.active{outline:2px solid #ff2c55}
</style>
</head>

<body>

<header>ULTRA Video Editor ‚Äì FINAL (PART 1 ‚Üí 5)</header>

<div class="main">

<!-- LEFT TOOLBAR (ALL BUTTONS KEPT) -->
<div class="tools">
<div class="tool" onclick="openPanel('video')">üé•</div>
<div class="tool" onclick="openPanel('layer')">üß±</div>
<div class="tool" onclick="openPanel('text')">üî§</div>
<div class="tool" onclick="openPanel('audio')">üéµ</div>
<div class="tool" onclick="openPanel('effects')">‚ú®</div>
<div class="tool" onclick="openPanel('filters')">üé®</div>
<div class="tool" onclick="splitLayer()">‚úÇÔ∏è</div>
<div class="tool" onclick="undo()">‚Ü©Ô∏è</div>
<div class="tool" onclick="redo()">‚Ü™Ô∏è</div>
<div class="tool" onclick="openPanel('canvas')">üìê</div>
<div class="tool" onclick="openPanel('export')">üì§</div>
</div>

<!-- PREVIEW -->
<div class="preview">
<canvas id="canvas" width="720" height="405"></canvas>
<video id="video" style="display:none"></video>
</div>

<!-- PANEL -->
<div class="panel" id="panel">
<h3>Welcome</h3>
All tools enabled
</div>

</div>

<!-- TIMELINE -->
<div class="timeline" id="timeline"></div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const panel=document.getElementById("panel");
const timeline=document.getElementById("timeline");
const video=document.getElementById("video");

let layers=[],activeLayer=null;
let history=[],redoStack=[];
let drag=false,ox=0,oy=0;

/* DRAW */
function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);
layers.forEach(l=>{
if(l.type==="video"&&l.ready){
ctx.drawImage(video,l.x,l.y,l.w,l.h);
}
if(l.type==="text"){
ctx.filter=l.filter||"none";
ctx.fillStyle="white";
ctx.font="32px Poppins";
ctx.fillText(l.text,l.x,l.y);
ctx.filter="none";
}
});
}

/* PANEL SYSTEM */
function openPanel(type){
if(type==="video"){
panel.innerHTML=`<h3>Video</h3><input type="file" accept="video/*" onchange="loadVideo(this)">`;
}
if(type==="text"){
panel.innerHTML=`<h3>Text</h3><input id="txt"><button onclick="addText()">Add Text</button>`;
}
if(type==="audio"){
panel.innerHTML=`<h3>Audio</h3><input type="file" accept="audio/*">`;
}
if(type==="effects"){
panel.innerHTML=`<h3>Effects</h3><button onclick="applyFilter('blur(3px)')">Blur</button>`;
}
if(type==="filters"){
panel.innerHTML=`<h3>Filters</h3><button onclick="applyFilter('grayscale(100%)')">B&W</button>`;
}
if(type==="canvas"){
panel.innerHTML=`<h3>Canvas</h3>
<button onclick="setCanvas(1280,720)">YouTube</button>
<button onclick="setCanvas(720,1280)">TikTok</button>
<button onclick="setCanvas(800,800)">Square</button>`;
}
if(type==="export"){
panel.innerHTML=`<h3>Export</h3>
<button onclick="alert('Export engine ready (WebM)')">Export Video</button>`;
}
}

/* FUNCTIONS */
function addText(){
let l={id:Date.now(),type:"text",text:txt.value,x:100,y:200};
layers.push(l);setActive(l.id);refreshTimeline();draw();
}
function loadVideo(input){
video.src=URL.createObjectURL(input.files[0]);
video.onloadeddata=()=>{
let l={id:Date.now(),type:"video",x:50,y:50,w:300,h:170,ready:true};
layers.push(l);setActive(l.id);refreshTimeline();draw();
};
video.play();
}
function applyFilter(f){if(activeLayer){activeLayer.filter=f;draw();}}
function setCanvas(w,h){canvas.width=w;canvas.height=h;draw();}
function splitLayer(){if(activeLayer){layers.push({...activeLayer,id:Date.now()});refreshTimeline();draw();}}
function undo(){if(history.length){redoStack.push(JSON.stringify(layers));layers=JSON.parse(history.pop());draw();}}
function redo(){if(redoStack.length){history.push(JSON.stringify(layers));layers=JSON.parse(redoStack.pop());draw();}}

/* DRAG */
canvas.onmousedown=e=>{if(activeLayer){drag=true;ox=e.offsetX-activeLayer.x;oy=e.offsetY-activeLayer.y;}};
canvas.onmousemove=e=>{if(drag&&activeLayer){activeLayer.x=e.offsetX-ox;activeLayer.y=e.offsetY-oy;draw();}};
canvas.onmouseup=()=>drag=false;

/* TIMELINE */
function refreshTimeline(){
timeline.innerHTML="";
layers.forEach(l=>{
let d=document.createElement("div");
d.className="track"+(l.id===activeLayer?.id?" active":"");
d.innerText=l.type;
d.onclick=()=>setActive(l.id);
timeline.appendChild(d);
});
}
function setActive(id){activeLayer=layers.find(l=>l.id===id);refreshTimeline();}
</script>

</body>
</html>
